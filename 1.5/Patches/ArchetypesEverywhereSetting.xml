<?xml version="1.0" encoding="utf-8" ?>
<Patch>
    <Operation Class="SuperHeroGenesBase.PatchOperationSetting">
        <setting>archetypesEverywhere</setting>
        <active Class="PatchOperationSequence">
            <operations>
                <!--Replace abilities with archetypes-->
                <li Class="PatchOperationConditional">
                    <xpath>Defs/XenotypeDef/genes/li[text()="FireSpew"]</xpath>
                    <match Class="PatchOperationReplace">
                        <xpath>Defs/XenotypeDef/genes/li[text()="FireSpew"]</xpath>
                        <value>
                            <li>SHG_Archetypes_Pyromancer</li>
                        </value>
                    </match>
                </li>

                <li Class="PatchOperationConditional">
                    <xpath>Defs/XenotypeDef/genes/li[text()="FoamSpray"]</xpath>
                    <match Class="PatchOperationReplace">
                        <xpath>Defs/XenotypeDef/genes/li[text()="FoamSpray"]</xpath>
                        <value>
                            <li>SHG_Archetypes_Firefighter</li>
                        </value>
                    </match>
                </li>

                <li Class="PatchOperationConditional">
                    <xpath>Defs/XenotypeDef/genes/li[text()="LongjumpLegs"]</xpath>
                    <match Class="PatchOperationReplace">
                        <xpath>Defs/XenotypeDef/genes/li[text()="LongjumpLegs"]</xpath>
                        <value>
                            <li>SHG_Archetypes_Skirmisher</li>
                        </value>
                    </match>
                </li>

                <li Class="PatchOperationConditional">
                    <xpath>Defs/XenotypeDef/genes/li[text()="AnimalWarcall"]</xpath>
                    <match Class="PatchOperationReplace">
                        <xpath>Defs/XenotypeDef/genes/li[text()="AnimalWarcall"]</xpath>
                        <value>
                            <li>SHG_Archetypes_Druid</li>
                        </value>
                    </match>
                </li>

                <li Class="PatchOperationConditional">
                    <xpath>Defs/XenotypeDef/genes/li[text()="Coagulate"]</xpath>
                    <match Class="PatchOperationReplace">
                        <xpath>Defs/XenotypeDef/genes/li[text()="Coagulate"]</xpath>
                        <value>
                            <li>SHG_Archetypes_Medic</li>
                        </value>
                    </match>
                </li>

                <li Class="PatchOperationConditional">
                    <xpath>Defs/XenotypeDef/genes/li[text()="PiercingSpine"]</xpath>
                    <match Class="PatchOperationReplace">
                        <xpath>Defs/XenotypeDef/genes/li[text()="PiercingSpine"]</xpath>
                        <value>
                            <li>SHG_Archetypes_Analyzer</li>
                        </value>
                    </match>
                </li>

                <li Class="PatchOperationConditional">
                    <xpath>Defs/XenotypeDef/genes/li[text()="AcidSpray"]</xpath>
                    <match Class="PatchOperationReplace">
                        <xpath>Defs/XenotypeDef/genes/li[text()="AcidSpray"]</xpath>
                        <value>
                            <li>SHG_Archetypes_Caustimancer</li>
                        </value>
                    </match>
                </li>

                <li Class="PatchOperationConditional">
                    <xpath>Defs/XenotypeDef[defName="Dirtmole"]/genes/li[text()="AptitudeRemarkable_Mining"]</xpath>
                    <match Class="PatchOperationReplace">
                        <xpath>Defs/XenotypeDef[defName="Dirtmole"]/genes/li[text()="AptitudeRemarkable_Mining"]</xpath>
                        <value>
                            <li>SHG_Archetypes_Geomancer</li>
                        </value>
                    </match>
                </li>

                <!--Toximancer gives immunity to toxigas and adds 1 to toxic resistance-->
                <li Class="PatchOperationConditional">
                    <xpath>Defs/XenotypeDef/genes/li[text()="ToxicEnvironmentResistance_Partial"]</xpath>
                    <match Class="PatchOperationReplace">
                        <xpath>Defs/XenotypeDef/genes/li[text()="ToxicEnvironmentResistance_Partial"]</xpath>
                        <value>
                            <li>SHG_Archetypes_Toximancer</li>
                        </value>
                    </match>
                </li>

                <li Class="PatchOperationConditional">
                    <xpath>Defs/XenotypeDef/genes/li[text()="ToxicEnvironmentResistance_Total"]</xpath>
                    <match Class="PatchOperationReplace">
                        <xpath>Defs/XenotypeDef/genes/li[text()="ToxicEnvironmentResistance_Total"]</xpath>
                        <value>
                            <li>SHG_Archetypes_Toximancer</li>
                        </value>
                    </match>
                </li>

                <li Class="PatchOperationConditional">
                    <xpath>Defs/XenotypeDef/genes/li[text()="ToxResist_Partial"]</xpath>
                    <match Class="PatchOperationReplace">
                        <xpath>Defs/XenotypeDef/genes/li[text()="ToxResist_Partial"]</xpath>
                        <value>
                            <li>SHG_Archetypes_Toximancer</li>
                        </value>
                    </match>
                </li>

                <li Class="PatchOperationConditional">
                    <xpath>Defs/XenotypeDef/genes/li[text()="ToxResist_Total"]</xpath>
                    <match Class="PatchOperationReplace">
                        <xpath>Defs/XenotypeDef/genes/li[text()="ToxResist_Total"]</xpath>
                        <value>
                            <li>SHG_Archetypes_Toximancer</li>
                        </value>
                    </match>
                </li>

                <li Class="PatchOperationConditional">
                    <xpath>Defs/XenotypeDef/genes/li[text()="ToxResist_Total"]</xpath>
                    <match Class="PatchOperationReplace">
                        <xpath>Defs/XenotypeDef/genes/li[text()="ToxResist_Total"]</xpath>
                        <value>
                            <li>SHG_Archetypes_Toximancer</li>
                        </value>
                    </match>
                </li>

                <li Class="PatchOperationConditional">
                    <xpath>Defs/XenotypeDef/genes/li[text()="MinTemp_SmallDecrease"]</xpath>
                    <match Class="PatchOperationReplace">
                        <xpath>Defs/XenotypeDef/genes/li[text()="MinTemp_SmallDecrease"]</xpath>
                        <value>
                            <li>SHG_Archetypes_Pugilist</li>
                        </value>
                    </match>
                </li>

                <li Class="PatchOperationConditional">
                    <xpath>Defs/XenotypeDef/genes/li[text()="MinTemp_LargeDecrease"]</xpath>
                    <match Class="PatchOperationReplace">
                        <xpath>Defs/XenotypeDef/genes/li[text()="MinTemp_LargeDecrease"]</xpath>
                        <value>
                            <li>SHG_Archetypes_Cryomancer</li>
                        </value>
                    </match>
                </li>

                <!--Attractive pawns gain the stunner archetype, which gives beauty and support abilities-->
                <li Class="PatchOperationConditional">
                    <xpath>Defs/XenotypeDef/genes/li[text()="Beauty_Pretty"]</xpath>
                    <match Class="PatchOperationReplace">
                        <xpath>Defs/XenotypeDef/genes/li[text()="Beauty_Pretty"]</xpath>
                        <value>
                            <li>SHG_Archetypes_Stunner</li>
                        </value>
                    </match>
                </li>

                <li Class="PatchOperationConditional">
                    <xpath>Defs/XenotypeDef/genes/li[text()="Beauty_Beautiful"]</xpath>
                    <match Class="PatchOperationReplace">
                        <xpath>Defs/XenotypeDef/genes/li[text()="Beauty_Beautiful"]</xpath>
                        <value>
                            <li>SHG_Archetypes_Stunner</li>
                        </value>
                    </match>
                </li>

                <li Class="PatchOperationConditional">
                    <xpath>Defs/XenotypeDef/genes/li[text()="Beauty_ExtremelyBeautiful"]</xpath>
                    <match Class="PatchOperationReplace">
                        <xpath>Defs/XenotypeDef/genes/li[text()="Beauty_ExtremelyBeautiful"]</xpath>
                        <value>
                            <li>SHG_Archetypes_Stunner</li>
                        </value>
                    </match>
                </li>

                <li Class="PatchOperationConditional">
                    <xpath>Defs/XenotypeDef/genes/li[text()="Beauty_SuperBeautiful"]</xpath>
                    <match Class="PatchOperationReplace">
                        <xpath>Defs/XenotypeDef/genes/li[text()="Beauty_SuperBeautiful"]</xpath>
                        <value>
                            <li>SHG_Archetypes_Stunner</li>
                        </value>
                    </match>
                </li>

                <li Class="PatchOperationConditional">
                    <xpath>Defs/XenotypeDef/genes/li[text()="Beauty_UnbelievablyBeautiful"]</xpath>
                    <match Class="PatchOperationReplace">
                        <xpath>Defs/XenotypeDef/genes/li[text()="Beauty_UnbelievablyBeautiful"]</xpath>
                        <value>
                            <li>SHG_Archetypes_Stunner</li>
                        </value>
                    </match>
                </li>

                <!--Cleanup-->

                <li Class="PatchOperationConditional">
                    <xpath>Defs/XenotypeDef[defName="Impid"]/genes/li[text()="FireResistant"]</xpath>
                    <match Class="PatchOperationRemove">
                        <xpath>Defs/XenotypeDef[defName="Impid"]/genes/li[text()="FireResistant"]</xpath>
                    </match>
                </li>
                
                <li Class="SuperHeroGenesBase.PatchOperationSetting">
                    <setting>multipleArchetypes</setting>
                    <inactive Class="PatchOperationSequence">
                        <operations>
                            <li Class="PatchOperationConditional">
                                <xpath>Defs/XenotypeDef[defName="Hussar"]/genes/li[text()="SHG_Archetypes_Toximancer"]</xpath>
                                <match Class="PatchOperationReplace">
                                    <xpath>Defs/XenotypeDef[defName="Hussar"]/genes/li[text()="SHG_Archetypes_Toximancer"]</xpath>
                                    <value>
                                        <li>ToxicEnvironmentResistance_Partial</li>
                                    </value>
                                </match>
                            </li>
                            <li Class="PatchOperationConditional">
                                <xpath>Defs/XenotypeDef[defName="Sanguophage"]/genes/li[text()="SHG_Archetypes_Medic"]</xpath>
                                <match Class="PatchOperationReplace">
                                    <xpath>Defs/XenotypeDef[defName="Sanguophage"]/genes/li[text()="SHG_Archetypes_Medic"]</xpath>
                                    <value>
                                        <li>Coagulate</li>
                                    </value>
                                </match>
                            </li>
                            <li Class="PatchOperationConditional">
                                <xpath>Defs/XenotypeDef[defName="Sanguophage"]/genes/li[text()="SHG_Archetypes_Analyzer"]</xpath>
                                <match Class="PatchOperationReplace">
                                    <xpath>Defs/XenotypeDef[defName="Sanguophage"]/genes/li[text()="SHG_Archetypes_Analyzer"]</xpath>
                                    <value>
                                        <li>PiercingSpine</li>
                                    </value>
                                </match>
                            </li>
                            <li Class="PatchOperationConditional">
                                <xpath>Defs/XenotypeDef[defName="Sanguophage"]/genes/li[text()="SHG_Archetypes_Stunner"]</xpath>
                                <match Class="PatchOperationReplace">
                                    <xpath>Defs/XenotypeDef[defName="Sanguophage"]/genes/li[text()="SHG_Archetypes_Stunner"]</xpath>
                                    <value>
                                        <li>Beauty_Pretty</li>
                                    </value>
                                </match>
                            </li>
                            <li Class="PatchOperationConditional">
                                <xpath>Defs/XenotypeDef[defName="Sanguophage"]/genes/li[text()="SHG_Archetypes_Toximancer"]</xpath>
                                <match Class="PatchOperationReplace">
                                    <xpath>Defs/XenotypeDef[defName="Sanguophage"]/genes/li[text()="SHG_Archetypes_Toximancer"]</xpath>
                                    <value>
                                        <li>ToxResist_Total</li>
                                    </value>
                                </match>
                            </li>
                        </operations>
                    </inactive>
                </li>
            </operations>
        </active>
    </Operation>
</Patch>
